---
title: "Análisis Univariado y Bivariado"
output:
  html_document:
    df_print: paged
  word_document: default
  pdf_document: default
editor_options:
  chunk_output_type: console
---
Importamos la data desde un repositorio de Github
```{r}
library(rio)
link="https://github.com/alessiasibille17/Trabajo_Stad/raw/master/entrega2_final/mergefinal.xlsx"
datamerge=import(link)
```
ANÁLISIS UNIVARIADO
```{r}
#Antes que nada, colocamos los nombres de los países en row.names
row.names(datamerge)=datamerge$Pais
#Activamos las librerías que usaremos
library(DescTools)
library(psych)
#eliminamos la columna con los países, pues estos ya se encuentran en los row names.
datamerge$Pais= NULL
```

VARIABLE - MATRICULA
```{r}
#identificando la variable 
str(datamerge)
class(datamerge$Matricula)
summary(datamerge$Matricula)
table(datamerge$Matricula)

#nalisis estadistico 
median(datamerge$Matricula,na.rm=T)
mean(datamerge$Matricula,na.rm=T)
Mode(datamerge$Matricula,na.rm=T)
sd(datamerge$Matricula,na.rm=T)
table(datamerge$Matricula)
prop.table(table(datamerge$Matricula))*100

#Grafico de la variable matricula
boxplot(datamerge$Matricula)
graficomatricula <- (datamerge$Matricula)
hist(graficomatricula, col= rainbow(10), 
     xlab="Países",
     ylab="Porcentaje de alumnos matriculados en la escuela secundaria",
     main=" ALUMNOS MATRICULADOS POR PAÍS")

#Grafico de la variable matricula en boxplot
boxplot(datamerge$Matricula, main="BOXPLOT DE ALUMNOS MATRICULADOS POR PAÍS", col="Yellow",
        xlab="país", ylab="Porcentaje de alumnos matriculados en la escuela secundaria")
```

```{r}
#Para visualizar los descriptivos de manera más clara
library(table1)
table1::label(datamerge$Matricula) <- "Porcentaje de alumnos matriculados en el nivel secundario"
table1(~Matricula, data = datamerge)
table1
```


VaRIABLE PBI-PERCAPITA 
```{r}
#identificando la variable 
str(datamerge)
class(datamerge$PBIPC)
summary(datamerge$PBIPC)
table(datamerge$PBIPC)

#analisis estadistico 
median(datamerge$PBIPC,na.rm=T)
mean(datamerge$PBIPC,na.rm=T)
Mode(datamerge$PBIPC,na.rm=T)
sd(datamerge$PBIPC,na.rm=T)
table(datamerge$PBIPC)
prop.table(table(datamerge$PBIPC))*100

#Para visualizar los descriptivos de manera más clara
table1::label(datamerge$PBIPC) <- "PBI per cápita (nominal) por país"
table1(~PBIPC, data = datamerge, )

#Grafico de la variable PBIPC
graficoPBIPC <- (datamerge$PBIPC)
hist(graficoPBIPC, col= rainbow(10), 
     xlab="PBI per cápita (nominal)",
     main="PBI PER CÁPITA POR PAÍS")
#Grafico de la variable PBIPERCAPITA en boxplot
boxplot(datamerge$PBIPC, main="BOXPLOT DE PBI PER CAPITA POR PAIS ", col="Red",xlab="países",ylab="PBI per cápita (nominal)")
```
VARIABLE-NIVEL DE POBREZA
```{r}
#identificando la variable 
str(datamerge)
class(datamerge$Pobreza)
summary(datamerge$Pobreza)
table(datamerge$Pobreza)

#análisis estadístico 
median(datamerge$Pobreza,na.rm=T)
mean(datamerge$Pobreza,na.rm=T)
Mode(datamerge$Pobreza,na.rm=T)
sd(datamerge$Pobreza,na.rm=T)
table(datamerge$Pobreza)
prop.table(table(datamerge$Pobreza))*100

#Para visualizar los descriptivos de manera más clara
table1::label(datamerge$Pobreza) <- "Porcentaje de la población bajo la línea nacional de pobreza"
table1::table1(~Pobreza, data = datamerge, )

#Grafico de la variable Pobreza 
graficopobreza <- (datamerge$Pobreza)
hist(graficopobreza, col= rainbow(10), 
     main="PORCENTAJE DE POBREZA POR PAÍS",
     xlab="Porcentaje de la población bajo la línea nacional de pobreza",ylab="Países")
#Grafico de la variable Pobreza en boxplot
boxplot(datamerge$Pobreza, main="BOXPLOT DE POBREZA ", col="Blue",
        xlab="países", ylab="Porcentaje de la población bajo la línea nacional de pobreza")
```
VARIABLE-URBANO 
```{r}
#Identificando la variable 
str(datamerge)
class(datamerge$URBANO)
summary(datamerge$URBANO)
table(datamerge$URBANO)

#Análisis estadístico 
median(datamerge$URBANO,na.rm=T)
mean(datamerge$URBANO,na.rm=T)
Mode(datamerge$URBANO,na.rm=T)
sd(datamerge$URBANO,na.rm=T)
table(datamerge$URBANO)
prop.table(table(datamerge$URBANO))*100

#Para visualizar los descriptivos de manera más clara
table1::label(datamerge$URBANO) <- "Porcentaje de urbanización por país"
table1::table1(~URBANO, data = datamerge, )

#Gráfico de la variable urbano
graficourbano <- (datamerge$URBANO)
hist(graficourbano, col= rainbow(10), 
     xlab="Países",
     ylab="Porcentaje de urbanización",
     main="PORCENTAJE DE URBANIZACIÓN POR PAÍS")
#Gráfico de la variable URBANO en boxplot
boxplot(datamerge$URBANO, main="BOXPLOT PORCENTAJE DE URBANIZACIÓN POR PAÍS ", col="light pink",
        xlab="países", ylab="Porcentaje de urbanización")

```
VARIABLE-SEXO
```{r}
#identificando la variable 
str(datamerge)
class(datamerge$SEXO)
summary(datamerge$SEXO)
table(datamerge$SEXO)

#analisis estadistico 
median(datamerge$SEXO,na.rm=T)
mean(datamerge$SEXO,na.rm=T)
Mode(datamerge$SEXO,na.rm=T)
sd(datamerge$SEXO,na.rm=T)
table(datamerge$SEXO)
prop.table(table(datamerge$SEXO))*100

#Para visualizar los descriptivos de manera más clara
table1::label(datamerge$SEXO) <- "Porcentaje de población femenina"
table1::table1(~SEXO, data = datamerge, )


#Grafico de la variable sexo
graficosexo <- (datamerge$SEXO)
hist(graficosexo, col= rainbow(10), 
     xlab="Porcentaje de población femenina",
     ylab="Países",
     main="PORCENTAJE DE POBLACIÓN FEMENINA POR PAÍS")
#Grafico de la variable SEXO en boxplot
boxplot(datamerge$SEXO, main="BOXPLOT PORCENTAJE DE POBLACIÓN FEMENINA POR PAÍS ", col="orchid",
        xlab="países", ylab="Porcentaje de población femenina")
```
VARIABLE - GASTO EN EDUCACION
```{r}
#identificando la variable 
str(datamerge)
class(datamerge$gastoedu)
summary(datamerge$gastoedu)
table(datamerge$gastoedu)

#analisis estadistico 
median(datamerge$gastoedu,na.rm=T)
mean(datamerge$gastoedu,na.rm=T)
Mode(datamerge$gastoedu,na.rm=T)
sd(datamerge$gastoedu,na.rm=T)
table(datamerge$gastoedu)
prop.table(table(datamerge$gastoedu))*100

#Para visualizar los descriptivos de manera más clara
table1::label(datamerge$gastoedu) <- "Porcentaje del PBI invertido en educación por parte del Estado"
table1::table1(~PBIPC, data = datamerge, )


#Grafico de la variable urbano
graficogastoedu <- (datamerge$gastoedu)
hist(graficogastoedu, col= rainbow(10),xlab="Porcentaje de inversión en educación por parte del Estado", main="PORCENTAJE DE INVERSIÓN ESTATAL EN EDUCACIÓN POR PAÍS")
#Grafico de la variable gasatoeduA en boxplot
boxplot(datamerge$gastoedu, main="BOXPLOT DE PORCENTAJE DE INVERSIÓN ESTATAL EN EDUCACIÓN POR PAÍS", col="light green",xlab="países", ylab="Porcentaje de inversión en educación por parte del Estado")
```
VARIABLE-PROFESORES POR ESTUDIANTE EN SECUNDARIA 
```{r}
#identificando la variable 
str(datamerge)
class(datamerge$profxes)
summary(datamerge$profxes)
table(datamerge$profxes)

#analisis estadistico 
median(datamerge$profxes,na.rm=T)
mean(datamerge$profxes,na.rm=T)
Mode(datamerge$profxes,na.rm=T)
sd(datamerge$profxes,na.rm=T)
table(datamerge$profxes)
prop.table(table(datamerge$profxes))*100

#Para visualizar los descriptivos de manera más clara
table1::label(datamerge$profxes) <- "Promedio de estudiantes por maestro"
table1::table1(~profxes, data = datamerge, )


#Grafico de la variable PROFEX
graficoprofxes <- (datamerge$profxes)

hist(graficoprofxes, col= rainbow(10), 
     ylab="Países",
     xlab="Cantidad de estudiantes por profesor",
     main="CANTIDAD DE ESTUDIANTES EN EDUCACIÓN SECUNDARIA POR PROFESOR POR PAÍSES")
#Grafico de la variable profex en boxplot
boxplot(datamerge$profxes, main="BOXPLOT DE CANTIDAD DE ESTUDIANTES EN EDUCACIÓN SECUNDARIA POR PROFESOR POR PAÍSES ", col="paleturquoise", xlab="países", ylab="Cantidad de estudiantes por profesor")
     
```
VARIABLE- TOTAL CONSUMO DE ALCOHOL POR JOVENES 
```{r}
#identificando la variable 
str(datamerge)
class(datamerge$totalAC)
summary(datamerge$totalAC)
table(datamerge$totalAC)

#analisis estadistico 
median(datamerge$totalAC,na.rm=T)
mean(datamerge$totalAC,na.rm=T)
Mode(datamerge$totalAC,na.rm=T)
sd(datamerge$totalAC,na.rm=T)
table(datamerge$totalAC)
prop.table(table(datamerge$totalAC))*100

#Para visualizar los descriptivos de manera más clara
table1::label(datamerge$totalAC) <- "Porcentaje de jóvenes que consumen alcohol"
table1::table1(~totalAC, data = datamerge, )

#Grafico de la variable urbano
graficototalAC <- (datamerge$totalAC)
hist(graficototalAC, col= rainbow(10), 
     xlab="Porcentaje de jovenes que consumen alcohol",
     ylab="Países",
     main="PORCENTAJE DE JOVENES QUE CONSUMEN ALCOHOL POR PAÍS")
#Grafico de la variable totalAC en boxplot
boxplot(datamerge$totalAC, main="BOXPLOT DE PORCENTAJE DE JÓVENES QUE CONSUMEN ALCOHOL POR PAÍS  ", col="Skyblue",
        xlab="países", ylab="Porcentaje de jovenes que consumen alcohol")
```
VARIABLE- TASA DE NATALIDAD DE ADOLESCENTES POR PAÍS 

```{r}
#identificando la variable 
str(datamerge)
class(datamerge$rateper1000AP)
summary(datamerge$rateper1000AP)
table(datamerge$rateper1000AP)

#analisis estadistico 
median(datamerge$rateper1000AP,na.rm=T)
mean(datamerge$rateper1000AP,na.rm=T)
Mode(datamerge$rateper1000AP,na.rm=T)
sd(datamerge$rateper1000AP,na.rm=T)
table(datamerge$rateper1000AP)
prop.table(table(datamerge$rateper1000AP))*100

#Para visualizar los descriptivos de manera más clara
table1::label(datamerge$rateper1000AP) <- "Porcentaje de natalidad por cada 1000 mujeres de 15 a 19 años"
table1::table1(~rateper1000AP, data = datamerge, )

#Grafico de la variable rater1000AP
graficorateper1000AP<- (datamerge$rateper1000AP)
hist(graficorateper1000AP, col= rainbow(10), 
     xlab="Tasa de natalidad por cada 1000 mujeres de 15 a 19 años",
     ylab="Países",
     main="TASA DE NATALIDAD POR 1000 MUJERES DE 15 A 19 AÑOS POR PAÍS")
#Grafico de la variable rateper1000AP en boxplot
boxplot(datamerge$rateper1000AP, main="BOXPLOT DE NATALIDAD POR 1000 MUJERES DE 15 A 19 AÑOS POR PAÍS", col="goldenrod",xlab="países", ylab="Tasa de natalidad por 1000 mujeres de 15 a 19 años")
```


*ANÁLISIS BIVARIADO*

V. EXPLICADA = MATRICULA
VARIABLES EXPLICATIVAS: 

A)v. EXPLICATIVA1= PBIPC
```{r}
attach(datamerge)
plot(datamerge$Matricula,datamerge$PBIPC, xlab="Porcentaje de alumnos matriculados", 
     ylab="PBI-percapita", main="Análisis bivariado entre el porcentaje de alumnos matriculados y el PBI-percapita")
cor.test(datamerge$Matricula, datamerge$PBIPC)
```
B)v. EXPLICATIVA2= Pobreza
```{r}
plot(datamerge$Matricula, datamerge$Pobreza,xlab="Porcentaje de estudiantes matriculados", 
     ylab="Porcentaje de la población debajo de la línea de pobreza por país", main="Análisis bivariado entre el % de alumnos matriculados en el nivel secundario y el % de la población debajo de la línea de pobreza por país")
cor.test(datamerge$Matricula, datamerge$Pobreza)
```
C)v. EXPLICATIVA3= URBANO
```{r}
plot(datamerge$Matricula, datamerge$URBANO,xlab="Porcentaje de estudiantes matriculados en educación secundaria", 
     ylab="Porcentaje de población urbana", main="Análisis bivariado entre el % de estudiantes inscritos en el nivel secundario y el % de la población urbana")
cor.test(datamerge$Matricula, datamerge$URBANO)
```
D)v. EXPLICATIVA4= SEXO
```{r}
plot(datamerge$Matricula, datamerge$SEXO,xlab="Porcentaje de estudiantes matriculados en educación secundaria", 
     ylab="Porcentaje de población femenina", main="Análisis bivariado entre el % de estudiantes matriculados en el nivel secundario y el % de la población femenina")
cor.test(datamerge$Matricula, datamerge$SEXO)
```
E)v. EXPLICATIVA5= GASTOEDU
```{r}
plot(datamerge$Matricula,datamerge$gastoedu,xlab="Porcentaje de estudiantes matriculados en el nivel secundario", 
     ylab="Porcentaje de gasto en educación", main="Análisis bivariado entre el porcentaje de alumnos matriculados y el porcentaje de gasto en educación")
cor.test(datamerge$Matricula, datamerge$gastoedu)
```
F) v. EXPLICATIVA6= PROFXES
```{r}
plot(datamerge$Matricula,datamerge$profxes,xlab="Porcentaje de estudiantes matriculados en el nivel secundario", 
     ylab="Porporción de estudiantes por profesor", main="Análisis bivariado entre el % de alumnos matriculados en educación secundaria y la proporción de alumnos por profesor")
cor.test(datamerge$Matricula,datamerge$profxes)
```
G) v. EXPLICATIVA7= totalAC
```{r}
plot(datamerge$Matricula,datamerge$totalAC,xlab="Porcentaje de estudiantes matriculados en educación secundaria", 
     ylab="Porcentaje de consumo de alcohol", main="Análisis bivariado entre el porcentaje de alumnos matriculados en el nivel secundario y el porcentaje de consumo de alcohol")
cor.test(datamerge$Matricula,datamerge$totalAC)
```
H) v. EXPLICATIVA8= rateper1000AP
```{r}
plot(datamerge$Matricula,datamerge$rateper1000AP,xlab="Porcentaje de estudiantes matriculados en el nivel secundario", ylab="Tasa de natalidad adolescente por cada 1000 mujeres", main="Análisis bivariado entre el % de estudiantes matriculados en educación secundaria y la tasa de natalidad adolescente por cada 1000 mujeres")
cor.test(datamerge$Matricula,datamerge$rateper1000AP)
```
